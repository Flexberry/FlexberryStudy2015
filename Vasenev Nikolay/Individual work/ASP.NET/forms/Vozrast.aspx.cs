/*flexberryautogenerated="true"*/
using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using ICSSoft.STORMNET.Business;
using ICSSoft.STORMNET.Business.LINQProvider;
using System.Linq;
using ICSSoft.STORMNET.FunctionalLanguage.SQLWhere;
using System.Data.SqlClient;

namespace IIS.Авиакомпания
{
    public partial class Возраст : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {   int c=0;
            float f=0;
            //Mom.DataObjectTypes = new[] { typeof(ИнформацияОСамолете) };
            //Mom.View = ИнформацияОСамолете.Views.ИнформацияОСамолетеE;
            //Mom.Operations.New = false;
            //Mom.Operations.Edit = false;
            //Mom.Operations.EditInRow = false;
            //Mom.Operations.Delete = false;
            //Mom.Operations.DeleteInRow = false;


            ////if (Session["nomer"] != null && Session["s"] != null)
            ////{
            //var ds = DataServiceProvider.DataService;
            var ds = (SQLDataService)DataServiceProvider.DataService;
            var goods = ds.Query<ИнформацияОСамолете>(ИнформацияОСамолете.Views.Vozrast).ToList();
            foreach (var g in goods)
                if (g.ТипСамолета.Название == "Боинг" && g.ТипСамолета.Код == "746")
                {
                    c++;
                    f += (((DateTime.Now - g.Возраст).Days) / 365);
                }

            if (c != 0)
                Num2.Text = (Math.Round(f / c)) + "       При количестве самолетов = " + c;
            else Num2.Text = "Самолетов данного типа нет в нашем авиапарке";

        }
    }
}
